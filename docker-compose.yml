version: '3.8'

services:
  cdl-notifier:
    image: ghcr.io/trevordavies095/cdl-match-notifier-discord-bot:latest
    container_name: cdl-discord-bot
    restart: unless-stopped
    network_mode: bridge
    environment:
      # Required - replace with your actual values
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN}
      - DISCORD_CHANNEL_ID=${DISCORD_CHANNEL_ID}
      # Optional - uncomment and set as needed
      # - TEAM_IDS=
      # - TEAMS=
      - NOTIFY_MINUTES_BEFORE=${NOTIFY_MINUTES_BEFORE:-15}
      - SCHEDULE_FETCH_INTERVAL=${SCHEDULE_FETCH_INTERVAL:-60}
      - TEAM_ICS_FILE=${TEAM_ICS_FILE:-ical_links.txt}
      # - DISCORD_MENTION_ROLE_ID=
      # - DISCORD_MENTION_ROLE_NAME=
      - DISCORD_PING_EVERYONE=${DISCORD_PING_EVERYONE:-false}
    # Note: ical_links.txt is bundled in the Docker image, no volume mount needed
    volumes:
      - ./data:/app/data
    healthcheck:
      test: ["CMD", "python", "-c", "import sys; sys.exit(0)"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

